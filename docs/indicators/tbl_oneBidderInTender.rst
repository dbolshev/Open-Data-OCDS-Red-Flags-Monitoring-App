.. _tbl_oneBidderInTender:

tbl_oneBidderInTender
=====================

Данная аналитическая таблица хранит для каждой закупающей организации количество лотов, на которые пришло по одному участнику.

Данная аналитическая таблица содержит следующую информацию:
 - Идентификатор закупающей организации.
 - Количество лотов.
 
Пример того, как может выглядеть таблица:

====================== ================
Закупающая организация Количество лотов
---------------------- ----------------
Идентификатор 1        Количество 1
Идентификатор 2        Количество 2
Идентификатор 3        Количество 3
Идентификатор 4        Количество 4
Идентификатор 5        Количество 5
...                    ...
====================== ================

****************************
Расчет аналитической таблицы
****************************

****************************
Источники данных для расчета
****************************

Для расчета аналитической таблицы используются следующие источники данных:

- API системы государственных закупок в OCDS формате.

*************************************
Частота расчета аналитической таблицы
*************************************

Аналитическая таблица рассчитывается 1 раз в сутки.

****************
Поля для расчета
****************

- ``data.tender.datePublished``
- ``data.tender.procurementMethodDetail``
- ``data.parties.id``
- ``data.parties.roles``
- ``data.bids.details.tenderers.id``
- ``data.bids.details.status``
- ``data.tender.lots.id``

***********************
Формула расчета таблицы
***********************

1. Выбираем только закупки, у которых ``data.tender.procurementMethodDetails='oneStage'`` или ``data.tender.procurementMethodDetails='twoStage'``. Из найденных берем только те, у которых год из даты ``data.tender.datePublished`` равен текущему.

2. Для каждой найденной закупки проводим следующие действия.

3. Для каждого такого лота закупки делаем следующее.

3.1. Выбираем предложения участников на лот: ``data.tender.lots.id`` входит в массив ``data.bids.details.relatedLots.id``. Из найденных берем только те предложения, у которых ``data.bids.details.status='active'``.

3.2. Из найденных предложений выбираем идентификаторы участников - ``data.bids.details.tenderers.id``.

3.3. Оставляем только те лоты, на которые подано всего по одному предложению.

4. Для каждого идентификатора закупающей организации суммируем количество лотов, на которые подано всего 1 предложение и записываем в таблицу.

